import Doc from '~/components/layout/docs'
import { Image } from '~/components/media'
import Caption from '~/components/text/caption'
import Example from '~/components/example'
import Note from '~/components/text/note'
import { Code } from '~/components/text/code'
import Link from '~/components/text/link'
import Snippet from '~/components/snippet'
import { InlineCode } from '~/components/text/code'
import ProductName from '~/components/name/product-name'
import Spacer from '~/components/spacer'
import { PRODUCT_NAME } from '~/lib/constants'
import OrgName from '~/components/name/org-name'
import ProductShortName from '~/components/name/product-short-name'
import DeployButtonGenerator from '~/components/deploy-button-generator'

export const meta = {
  title: 'Deploy Button',
  description: `The Deploy Button can be used to deploy GitHub repositories and GitLab projects to ${PRODUCT_NAME}.`,
  editUrl: 'pages/docs/v2/more/deploy-button.mdx',
  lastEdited: '2020-07-20T12:51:54.000Z'
}

The <OrgName /> Deploy Button allows you to share your project by providing a link for others to clone to GitHub, GitLab, or Bitbucket, and have a deployment flow setup for them in a straightforward flow.

<DeployButtonGenerator />

## How Does it Work?

The Deploy Button allows users to create a new Project through the <OrgName /> Import Flow. When clicking the Button, the user will be able to clone a project with their Git account and set up automatic deployments in a straightforward flow.

You can [create your Deploy Button with the generator above](#generate-your-own).

### Import Flow

The base of the Deploy Button URL is the <OrgName /> Git Import Flow, found at <https://vercel.com/import/git>.

The Import Flow allows users to clone a Git repository or template with their GitHub, GitLab, or Bitbucket account and allows templates to create Deploy Buttons that allows setting up a project without touching any code.

<Image
  src={`${
    process.env.ASSETS
  }/docs/more/deploy-button/import-flow.png`}
  width={1360 / 2}
  height={1674 / 2}
  shadow
/>
<Caption>The <OrgName /> Import Flow deploying a <Link href="https://github.com/vercel/next.js/tree/canary/examples/cms-datocms#deploy-your-own">Next.js and DatoCMS project</Link>.</Caption>

## URL Parameter Reference

With the <OrgName /> Import Flow, you can add various URL query parameters to control the experience a user will have, depending on the requirements of your project.

<Note>
  The following is a reference of what each parameter achieves within a Deploy
  Button URL. Use the{' '}
  <Link href="#generate-your-own">Deploy Button Generator</Link> to help you
  create your own.
</Note>

### Repository URL

**Parameter**: `s`<br />
**Value**: The source Git repository URL.<br />
**Type**: String

The Repository URL parameter allows you to define a Git repository URL, optionally including the subdirectory within a repository, that users will clone when going through the <OrgName /> Import Flow.

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world"/>
<Caption>An example Deploy Button source URL using the <InlineCode>s</InlineCode> Repository URL parameter.</Caption>

<Note>
  The Repository URL parameter is required when sending a user to the{' '}
  <OrgName /> Import Flow to set up a project using a template from GitHub,
  GitLab, or Bitbucket.
</Note>

### Required Environment Variables

**Parameter**: `env`<br />
**Value**: A comma-separated list of required Environment Variable keys e.g., `TEST_KEY,TEST_API_KEY`.<br />
**Type**: String \[]

The Required Environment Variables parameter allows you to require users to fill in values of Environment Variables the app needs to run successfully.

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&env=PUBLIC_API_KEY"/>
<Caption>An example Deploy Button source URL using the <InlineCode>env</InlineCode> parameter.</Caption>

<Note>
  You cannot pass values using this parameter due to the URL being saved in the
  browser history, and thus not being a secure method.
</Note>

### Environment Variables Description

**Parameter**: `envDescription`<br />
**Value**: A short description of the [Required Environment Variables](#required-environment-variables).<br />
**Type**: String

The Environment Variables Description parameter allows you to define a URL encoded string that describes to a user what the [Required Environment Variables](#required-environment-variables) are used for.

<Note>The description provided through this parameter will only show if Required Environment Variables are set.</Note>
<Spacer />

<Image
  src={`${
    process.env.ASSETS
  }/docs/more/deploy-button/environment-variable-description.png`}
  width={1232 / 2}
  height={422 / 2}
  shadow
/>
<Caption>An example Required Environment Variables section utilising the Environment Variable Description parameter to add context.</Caption>

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&env=PUBLIC_API_KEY&envDescription=Enter%20your%20public%20API%20Key."/>
<Caption>An example Deploy Button source URL using the <InlineCode>envDescription</InlineCode> parameter.</Caption>

### Environment Variables Link

**Parameter**: `envLink`<br />
**Value**: A link to an explanation of the [Required Environment Variables](#required-environment-variables).<br />
**Type**: String

The Environment Variable Link parameter allows you to attach a link to external documentation that helps the user find more information about where the values for the Environment Variables can be found and what they are for.

<Note>The description provided through this parameter will only show if Required Environment Variables are set.</Note>
<Spacer />

<Image
  src={`${
    process.env.ASSETS
  }/docs/more/deploy-button/environment-variable-link.png`}
  width={1232 / 2}
  height={442 / 2}
  shadow
/>
<Caption>An example Required Environment Variables section utilising the Environment Variable Description parameter to add context.</Caption>

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&env=PUBLIC_API_KEY&envDescription=Enter%20your%20public%20API%20Key.&envLink=https://vercel.com/docs"/>
<Caption>An example Deploy Button source URL using the <InlineCode>envLink</InlineCode> parameter.</Caption>

<Note>
  The snippet above is just an example of using a URL with the{' '}
  <InlineCode>envLink</InlineCode> parameter. Please provider users with a
  specific link instead of top-level documentation.
</Note>

### Redirect URL

**Parameter**: `redirect-url`<br />
**Value**: The URL to redirect the user to on a successful deployment.<br />
**Type**: String

The Redirect URL parameter allows you to define a URL, other than the newly created <OrgName /> project, to send the user to after a successful deployment.

This parameter is helpful if you are sending a user from an application, to deploy a project with <OrgName />, but want the user to continue with your application with a frontend project created and deployed.

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&redirect-url=my-headless-application.com"/>
<Caption>An example Deploy Button source URL using the <InlineCode>redirect-url</InlineCode> parameter.</Caption>

<Note>
  You can provide a custom name and logo for the redirect UI by using the{' '}
  <Link href="#developer-id">Developer ID</Link> parameter.
</Note>

#### Callback Parameters

<OrgName /> additionally attaches some "Callback Parameters" with the user when redirected. The following parameters give you access to information about the project the user has created and deployed, for you to integrate with <OrgName /> after the user is sent back to you.

| Parameter                                                                                | Description                                                                                                                                                                                     |
| ---------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <InlineCode noWrap>project-dashboard-url</InlineCode>                                    | This defines the <OrgName /> Web UI Project View URL of the project that was created through the import flow.                                                                                   |
| <InlineCode noWrap>deployment-dashboard-url</InlineCode>                                 | This defines the <OrgName /> Web UI Deployment View URL of the deployment that was created through the import flow.                                                                             |
| <InlineCode noWrap>deployment-url</InlineCode>                                           | This defines the URL of the deployment that was created through the import flow. This contains the default production domain that was automatically generated for the project that was created. |
| <InlineCode noWrap>repository-url</InlineCode>                                           | This defines the URL of the Git repository that was created through the Import Flow, within the user's selected Git account (GitHub, GitLab, or Bitbucket).                                     |
| <InlineCode noWrap>production-deploy-hook-url</InlineCode> ([conditional](#deploy-hook)) | This defines the URL of a Deploy Hook. Requires [the `production-deploy-hook` parameter](#deploy-hook).                                                                                         |

### Developer ID

**Parameter**: `developer-id`<br />
**Value**: [Integration](/docs/integrations) Client ID.<br />
**Type**: String

The Developer ID parameter allows you to define a [<OrgName /> Integration](/docs/integrations) Client ID which will then attach your logo and name to the UI when using the [Redirect URL](#redirect-url) parameter.

<Note>This parameter requires the <Link href="#redirect-url">Redirect URL</Link> parameter to also be set.</Note>
<Spacer />

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&redirect-url=my-headless-application.com&developer-id=oac_7rUTiCMow23Gyfao9RQQ3Es2"/>
<Caption>An example Deploy Button source URL using the <InlineCode>redirect-url</InlineCode> and the <InlineCode>developer-id</InlineCode> parameters.</Caption>

### Deploy Hook

**Parameter**: `production-deploy-hook`<br />
**Value**: Name of the Deploy Hook to set up.<br />
**Type**: String

The Deploy Hook parameter allows you to receive [a URL](/docs/v2/more/deploy-hooks) when also using the Redirect URL parameter, which you can use to redeploy user's projects for them.

This is useful if you are directing a user to deploy a project that works with your application and you need to redeploy the user's project in case of a content change that needs to be rebuilt, for example, a headless CMS.

The value of this parameter should be the name of the [Deploy Hook](/docs/v2/more/deploy-hooks) you want to create for the user.

When redirected back to your application upon a successful deployment for the user, you will get the `production-deploy-hook-url` callback parameter in addition to [the default callback parameters](#callback-parameters).

<Note>This parameter requires the <Link href="#redirect-url">Redirect URL</Link> parameter to also be set.</Note>
<Spacer />

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&redirect-url=my-headless-application.com&production-deploy-hook=MyHeadlessCMS"/>
<Caption>An example Deploy Button source URL using the <InlineCode>redirect-url</InlineCode> and the <InlineCode>production-deploy-hook</InlineCode> parameters.</Caption>

### Project Name

**Parameter**: `project-name`<br />
**Value**: A default project name.<br />
**Type**: String

The Project Name parameter allows you to define a default project name.

This parameter is useful for cases such as if you already have context for what the user would like to name their project. For example, if you are sending the user to the Import Flow from an application that has already set up a project for the user that will connect to the created <OrgName /> project.

<Note>If there is a project using the name of the Project Name passed with this parameter, the user will be required to define a new project name, and therefore the project is not guaranteed to have the specified name.</Note>
<Spacer />

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&project-name=My%20Awesome%20Project"/>
<Caption>An example Deploy Button source URL using the <InlineCode>project-name</InlineCode> parameter.</Caption>

### Repository Name

**Parameter**: `repository-name`<br />
**Value**: A default repository name (no spaces).<br />
**Type**: String

The Repository Name parameter allows you to define a default project name.

Similar to the [Project Name](#project-name) parameter, this parameter is useful in cases where you already know what the user is likely to want to name the repository that is created in the [Import Flow](#import-flow).

<Snippet dark prompt={false} text="https://vercel.com/import/git?s=https://github.com/vercel/next.js/tree/canary/examples/hello-world&repository-name=my-awesome-project"/>
<Caption>An example Deploy Button source URL using the <InlineCode>repository-name</InlineCode> parameter.</Caption>

export default ({ children }) => <Doc meta={meta}>{children}</Doc>

export const config = {
  amp: 'hybrid'
}
